From 588ee23587e9d8dc271f55d3ff6086fef8fb4378 Mon Sep 17 00:00:00 2001
From: Alessio Igor Bogani <alessio.bogani@elettra.eu>
Date: Thu, 21 Apr 2016 10:41:02 +0200
Subject: [PATCH 3/3] Try to add PCI interrupt definition

---
 arch/powerpc/boot/dts/fsl/mvme7100.dts | 33 ++++++++++++++++++++++++++
 1 file changed, 33 insertions(+)

diff --git a/arch/powerpc/boot/dts/fsl/mvme7100.dts b/arch/powerpc/boot/dts/fsl/mvme7100.dts
index 964ca8d472fb..3f3b37b38ab7 100644
--- a/arch/powerpc/boot/dts/fsl/mvme7100.dts
+++ b/arch/powerpc/boot/dts/fsl/mvme7100.dts
@@ -137,6 +137,26 @@
 		reg = <0xf1008000 0x1000>;
 		ranges = <0x02000000 0x0 0x80000000 0x80000000 0x0 0x50000000
 			  0x01000000 0x0 0x00000000 0xf0000000 0x0 0x00800000>;
+		interrupt-map = <
+			/* IDSEL 18 - VME & USB */
+			0x1000 0x0 0x0 0x1 &mpic 0x3 0x1
+			0x1000 0x0 0x0 0x2 &mpic 0x0 0x1
+			0x1000 0x0 0x0 0x3 &mpic 0x1 0x1
+			0x1000 0x0 0x0 0x4 &mpic 0x2 0x1
+
+			/* IDSEL 20 - PMC2 Primary */
+			0x2000 0x0 0x0 0x1 &mpic 0x2 0x1
+			0x2000 0x0 0x0 0x2 &mpic 0x3 0x1
+			0x2000 0x0 0x0 0x3 &mpic 0x0 0x1
+			0x2000 0x0 0x0 0x4 &mpic 0x1 0x1
+
+			/* IDSEL 21 - PMC2 Secondary */
+			0x2800 0x0 0x0 0x1 &mpic 0x3 0x1
+			0x2800 0x0 0x0 0x2 &mpic 0x0 0x1
+			0x2800 0x0 0x0 0x3 &mpic 0x1 0x1
+			0x2800 0x0 0x0 0x4 &mpic 0x2 0x1
+			>;
+
 		pcie@0 {
 			ranges = <0x02000000 0x0 0x80000000
 				  0x02000000 0x0 0x80000000
@@ -152,6 +172,19 @@
 		reg = <0xf1009000 0x1000>;
 		ranges = <0x02000000 0x0 0xd0000000 0xd0000000 0x0 0x10000000
 			  0x01000000 0x0 0x00000000 0xf0800000 0x0 0x00800000>;
+		interrupt-map = <
+			/* IDSEL 20 - PMC1 Primary */
+			0x2000 0x0 0x0 0x1 &mpic 0x1 0x1
+			0x2000 0x0 0x0 0x2 &mpic 0x2 0x1
+			0x2000 0x0 0x0 0x3 &mpic 0x3 0x1
+			0x2000 0x0 0x0 0x4 &mpic 0x0 0x1
+
+			/* IDSEL 21 - PMC1 Secondary */
+			0x2800 0x0 0x0 0x1 &mpic 0x2 0x1
+			0x2800 0x0 0x0 0x2 &mpic 0x3 0x1
+			0x2800 0x0 0x0 0x3 &mpic 0x0 0x1
+			0x2800 0x0 0x0 0x4 &mpic 0x1 0x1
+			>;
 
 		pcie@0 {
 			ranges = <0x02000000 0x0 0xd0000000
-- 
2.17.1

