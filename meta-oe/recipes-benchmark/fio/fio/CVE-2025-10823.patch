From 6a39dfaffdb8a6c2080eec0dc7fb1ee532d54025 Mon Sep 17 00:00:00 2001
From: Jens Axboe <axboe@kernel.dk>
Date: Tue, 23 Sep 2025 11:50:46 -0600
Subject: [PATCH] options: check for NULL input string and fail

Waste of time busy work.

Link: https://github.com/axboe/fio/issues/1982

CVE: CVE-2025-10823

Upstream-Status: Backport
https://github.com/axboe/fio/commit/6a39dfaffdb8a6c2080eec0dc7fb1ee532d54025

Signed-off-by: Jens Axboe <axboe@kernel.dk>
Signed-off-by: Saravanan <saravanan.kadambathursubramaniyam@windriver.com>
---
 options.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/options.c b/options.c
index de935ef..b38441e 100644
--- a/options.c
+++ b/options.c
@@ -1535,6 +1535,9 @@ static int str_buffer_pattern_cb(void *data, const char *input)
 	struct thread_data *td = cb_data_to_td(data);
 	int ret;
 
+	if (!input)
+		return 1;
+
 	/* FIXME: for now buffer pattern does not support formats */
 	ret = parse_and_fill_pattern_alloc(input, strlen(input),
 				&td->o.buffer_pattern, NULL, NULL, NULL);
-- 
2.44.3

