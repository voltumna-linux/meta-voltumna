From 4cd6c8e85376a33bddd01fac143e27436d41f2b9 Mon Sep 17 00:00:00 2001
From: "Bruce A. Mah" <bmah@es.net>
Date: Tue, 24 Jun 2025 15:58:21 -0700
Subject: [PATCH] Prevent crash due to assertion failures on malformed
 authentication attempt.

Reported by Han Lee (Apple Information Security)
CVE-2025-54350

CVE: CVE-2025-54350
Upstream-Status: Backport [https://github.com/esnet/iperf/commit/4eab661da0bbaac04493fa40164e928c6df7934a]
Signed-off-by: Zhang Peng <peng.zhang1.cn@windriver.com>
---
 src/iperf_auth.c | 2 --
 1 file changed, 2 deletions(-)

diff --git a/src/iperf_auth.c b/src/iperf_auth.c
index 86b4eba..632f03d 100644
--- a/src/iperf_auth.c
+++ b/src/iperf_auth.c
@@ -28,7 +28,6 @@
 #include "iperf_config.h"
 
 #include <string.h>
-#include <assert.h>
 #include <time.h>
 #include <sys/types.h>
 /* FreeBSD needs _WITH_GETLINE to enable the getline() declaration */
@@ -152,7 +151,6 @@ int Base64Decode(const char* b64message, unsigned char** buffer, size_t* length)
 
     BIO_set_flags(bio, BIO_FLAGS_BASE64_NO_NL); //Do not use newlines to flush buffer
     *length = BIO_read(bio, *buffer, strlen(b64message));
-    assert(*length == decodeLen); //length should equal decodeLen, else something went horribly wrong
     BIO_free_all(bio);
 
     return (0); //success
-- 
2.50.0

