From d92467589216059aff46f545a7c3eba594103ee3 Mon Sep 17 00:00:00 2001
From: Thomas Blume <Thomas.Blume@suse.com>
Date: Fri, 16 May 2025 14:27:10 +0200
Subject: [PATCH] Don't allow suid and dev set on fs resize

Fixes: CVE-2025-6019

CVE: CVE-2025-6019
Upstream-Status: Backport [ https://github.com/storaged-project/libblockdev/commit/46b54414f66e965e3c37f8f51e621f96258ae22e ]

Signed-off-by: Changqing Li <changqing.li@windriver.com>
---
 src/plugins/fs/generic.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/plugins/fs/generic.c b/src/plugins/fs/generic.c
index eb6b5567..86051391 100644
--- a/src/plugins/fs/generic.c
+++ b/src/plugins/fs/generic.c
@@ -409,7 +409,7 @@ static gboolean xfs_resize_device (const gchar *device, guint64 new_size, const
                              "before resizing it.", device);
                 return FALSE;
             }
-            ret = bd_fs_mount (device, mountpoint, "xfs", NULL, NULL, error);
+            ret = bd_fs_mount (device, mountpoint, "xfs", "nosuid,nodev", NULL, error);
             if (!ret) {
                 g_prefix_error (error, "Failed to mount '%s' before resizing it: ", device);
                 return FALSE;
-- 
2.34.1

